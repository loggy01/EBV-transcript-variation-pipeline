{\rtf1\ansi\ansicpg1252\cocoartf2706
\cocoatextscaling0\cocoaplatform0{\fonttbl\f0\fnil\fcharset0 Calibri;\f1\fmodern\fcharset0 CourierNewPSMT;}
{\colortbl;\red255\green255\blue255;\red5\green99\blue193;}
{\*\expandedcolortbl;;\csgenericrgb\c1961\c38824\c75686;}
\paperw11900\paperh16840\margl1440\margr1440\vieww11520\viewh8400\viewkind0
\deftab720
\pard\pardeftab720\ri0\partightenfactor0

\f0\fs24 \cf0 \ul \ulc0 1. Long read basecalling with guppy (version 6.1.5)*\
\pard\pardeftab720\ri0\partightenfactor0
\cf0 \ulnone \
See {\field{\*\fldinst{HYPERLINK "https://denbi-nanopore-training-course.readthedocs.io/en/latest/basecalling/basecalling_1.html"}}{\fldrslt \cf2 \ul \ulc2 here}} and {\field{\*\fldinst{HYPERLINK "https://community.nanoporetech.com/docs/prepare/library_prep_protocols/Guppy-protocol/v/gpb_2003_v1_revaq_14dec2018/setting-up-a-run-configurations-and-parameters"}}{\fldrslt \cf2 \ul \ulc2 here}} for how to use guppy.\
\
\
\
\pard\pardeftab720\ri0\partightenfactor0
\cf0 \ul \ulc0 2. Long read alignment with Minimap2 (version 2.24.0)*\
\pard\pardeftab720\ri0\partightenfactor0
\cf0 \ulnone \
Splice aware alignment for dRNA-seq Oxford Nanopore datasets (annotation guided):\
\pard\pardeftab720\ri0\partightenfactor0

\f1\fs22 \cf0 \
minimap2 -ax splice -k14 -C5 --junc-bed annotation.bed ref.fa reads.fq > alignment.sam\
\pard\pardeftab720\ri0\partightenfactor0

\f0\fs24 \cf0 \
\
\
\pard\pardeftab720\ri0\partightenfactor0
\cf0 \ul \ulc0 3. SAM file preparation with SAMtools (version 1.17.0)\
\pard\pardeftab720\ri0\partightenfactor0
\cf0 \ulnone \
Removal of secondary and supplementary alignments:\
\
\pard\pardeftab720\ri0\partightenfactor0

\f1\fs22 \cf0 samtools view -F 256 -F 2048 -h alignment.sam > primary.sam\
\pard\pardeftab720\ri0\partightenfactor0

\fs24 \cf0 \
\
\pard\pardeftab720\ri0\partightenfactor0

\f0 \cf0 Conversion of primary alignment SAM file to sorted BAM file:\
\
\pard\pardeftab720\ri0\partightenfactor0

\f1\fs22 \cf0 samtools view -bS primary.sam > primary.bam\
\pard\pardeftab720\ri0\partightenfactor0

\fs24 \cf0 \
\pard\pardeftab720\ri0\partightenfactor0

\fs22 \cf0 samtools sort primary.bam > primary_sorted.bam\
\pard\pardeftab720\ri0\partightenfactor0

\fs24 \cf0 \
\
\pard\pardeftab720\ri0\partightenfactor0

\f0 \cf0 Pass to bam_filtration.R script to isolate EBV reads. Convert output to SAM file:\
\
\pard\pardeftab720\ri0\partightenfactor0

\f1\fs22 \cf0 samtools view -h ebv_reads.bam > ebv_reads.sam\
\pard\pardeftab720\ri0\partightenfactor0

\f0\fs24 \cf0 \
\
Remove header from EBV SAM file:\
\
\pard\pardeftab720\ri0\partightenfactor0

\f1\fs22 \cf0 samtools view ebv_reads.sam | cut -f 1-10 > ebv_reads_headerless.sam \
\pard\pardeftab720\ri0\partightenfactor0

\f0\fs24 \cf0 \
\
\
\
\
\
\pard\pardeftab720\ri0\partightenfactor0

\fs20 \cf0 \
\
\
\
\
*Parts one and two are optional and can vary depending on the dataset(s) you are using. However, part three must be followed to ensure the SAM file is properly prepared for pipeline use.\
}